{
'id': 'bugs.core_5776',
'qmid': None,
'tracker_id': 'CORE-5776',
'title': '"Input parameter mismatch" error after altering external function into PSQL function',
'description':
  """
    ::::: NB ::::
    Could not check actual result of fbtest execution, done only using ISQL and copy its result here.
    Checked on WI-T4.0.0.927, Win 64x.
  """,
'min_versions': '3.0.4',
'versions': [
{
 'firebird_version': '3.0',
 'platform': 'All',
 'test_type': 'ISQL',
 'test_script': 
  """
    set list on;
    set term ^;
    execute block as
    begin
        execute statement 'drop function sright';
        when any do begin end
    end
    ^
    set term ;^
    commit;

    declare external function sright
      varchar(100) by descriptor, 
      smallint,
      varchar(100) by descriptor returns parameter 3
      entry_point 'right' module_name 'fbudf';
    commit;


    select rdb$return_argument from rdb$functions
      where rdb$function_name = 'SRIGHT'; 

    select rdb$argument_position, rdb$argument_name from rdb$function_arguments
     where rdb$function_name = 'SRIGHT'; 

    ------------------------------------------------

    commit;

    set term ^;
    alter function sright (str varchar(100), len int)  returns varchar(100)
    as
    begin
      return right(str, len);
    end^
    set term ;^
    commit;

    select sright('function', 2) from rdb$database; 


    select rdb$return_argument from rdb$functions
      where rdb$function_name = 'SRIGHT'; 

    select rdb$argument_position, rdb$argument_name from rdb$function_arguments
     where rdb$function_name = 'SRIGHT'; 
  """,
  'expected_stdout':
  """
    RDB$RETURN_ARGUMENT             3

    RDB$ARGUMENT_POSITION           1
    RDB$ARGUMENT_NAME               <null>

    RDB$ARGUMENT_POSITION           2
    RDB$ARGUMENT_NAME               <null>

    RDB$ARGUMENT_POSITION           3
    RDB$ARGUMENT_NAME               <null>

    SRIGHT                          on

    RDB$RETURN_ARGUMENT             0

    RDB$ARGUMENT_POSITION           0
    RDB$ARGUMENT_NAME               <null>

    RDB$ARGUMENT_POSITION           1
    RDB$ARGUMENT_NAME               STR                                                                                                                                                                                                                                                         

    RDB$ARGUMENT_POSITION           2
    RDB$ARGUMENT_NAME               LEN                                                                                                                                                                                                                                                         
  """,
  'expected_stderr':
  """
  """
}
]
}
