{
'id': 'functional.gtcs.time_zone',
'qmid': None,
'tracker_id': '',
'title': 'GTCS/tests/FB_SQL_TIME_ZONE. Miscelaneous tests.',
'description':
 """
	Original test see in:
    https://github.com/FirebirdSQL/fbtcs/blob/master/GTCS/tests/FB_SQL_TIME_ZONE.script
    Checked on 4.0.0.1931.
 """,
'min_versions': '4.0.0',
'versions': [
{
 'firebird_version': '4.0',
  'platform': 'All',
 'init_script': 
  """
  """,
 'test_type': 'ISQL',
 'test_script': 
  """
    set list on;
    set time zone '00:00';

    select 'point-01' as msg,
           cast('01:23:45' as time with time zone),
           cast('2018-01-01 01:23:45' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45' as time with time zone)),
           extract(timezone_minute from cast('01:23:45' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           cast(cast('01:23:45' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-02' as msg,
           cast('01:23:45 +02:00' as time with time zone),
           cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_minute from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           cast(cast('01:23:45 +02:00' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-03' as msg,
           time '01:23:45 +02:00',
           timestamp '2018-01-01 01:23:45 +02:00',
           extract(timezone_hour from time '01:23:45 +02:00'),
           extract(timezone_minute from time '01:23:45 +02:00'),
           extract(timezone_hour from timestamp '2018-01-01 01:23:45 +02:00'),
           extract(timezone_minute from timestamp '2018-01-01 01:23:45 +02:00'),
           cast(time '01:23:45 +02:00' as time),
           cast(timestamp '2018-01-01 01:23:45 +02:00' as timestamp)
      from rdb$database;


    ---


    set time zone '-02:00';

    select 'point-04' as msg,
           cast('01:23:45' as time with time zone),
           cast('2018-01-01 01:23:45' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45' as time with time zone)),
           extract(timezone_minute from cast('01:23:45' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           cast(cast('01:23:45' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-05' as msg,
           cast('01:23:45 +02:00' as time with time zone),
           cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_minute from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           cast(cast('01:23:45 +02:00' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone) as timestamp)
      from rdb$database;


    ---


    select 'point-06' as msg,
           extract(hour from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(minute from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(second from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(millisecond from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(year from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(month from timestamp '2018-01-02 03:04:05.6789 -03:00'),
           extract(day from timestamp '2018-01-02 03:04:05.6789 -03:00')
      from rdb$database;

    select 'point-07' as msg,
           extract(hour from time '03:04:05.6789 -03:00'),
           extract(minute from time '03:04:05.6789 -03:00'),
           extract(second from time '03:04:05.6789 -03:00'),
           extract(millisecond from time '03:04:05.6789 -03:00')
      from rdb$database;


    ---


    -- DST starts at 2017-10-15 00:00 in America/Sao_Paulo

    select 'point-08' as msg,
           timestamp '2017-10-14 22:00 America/Sao_Paulo', extract(timezone_hour from timestamp '2017-10-14 22:00 America/Sao_Paulo'),
           timestamp '2017-10-14 22:00 America/Sao_Paulo' + 1, extract(timezone_hour from timestamp '2017-10-14 22:00 America/Sao_Paulo' + 1),
           timestamp '2017-10-14 22:00 America/Sao_Paulo' + 2, extract(timezone_hour from timestamp '2017-10-14 22:00 America/Sao_Paulo' + 2),
           timestamp '2017-10-14 22:00 America/Sao_Paulo' + 3, extract(timezone_hour from timestamp '2017-10-14 22:00 America/Sao_Paulo' + 3),
           timestamp '2017-10-16 22:00 America/Sao_Paulo', extract(timezone_hour from timestamp '2017-10-16 22:00 America/Sao_Paulo'),
           timestamp '2017-10-16 22:00 America/Sao_Paulo' - 1, extract(timezone_hour from timestamp '2017-10-16 22:00 America/Sao_Paulo' - 1),
           timestamp '2017-10-16 22:00 America/Sao_Paulo' - 2, extract(timezone_hour from timestamp '2017-10-16 22:00 America/Sao_Paulo' - 2),
           timestamp '2017-10-16 22:00 America/Sao_Paulo' - 3, extract(timezone_hour from timestamp '2017-10-16 22:00 America/Sao_Paulo' - 3)
      from rdb$database;

    select 'point-09' as msg,
           dateadd(1 hour to timestamp '2017-10-14 20:00 America/Sao_Paulo'),
           dateadd(2 hour to timestamp '2017-10-14 20:00 America/Sao_Paulo'),
           dateadd(3 hour to timestamp '2017-10-14 20:00 America/Sao_Paulo'),
           dateadd(4 hour to timestamp '2017-10-14 20:00 America/Sao_Paulo'),
           dateadd(5 hour to timestamp '2017-10-14 20:00 America/Sao_Paulo')
      from rdb$database;


    -- DST ends at 2018-02-18 00:00 in America/Sao_Paulo

    select 'point-10' as msg,
           timestamp '2018-02-17 22:00 America/Sao_Paulo', extract(timezone_hour from timestamp '2018-02-17 22:00 America/Sao_Paulo'),
           timestamp '2018-02-17 22:00 America/Sao_Paulo' + 1, extract(timezone_hour from timestamp '2018-02-17 22:00 America/Sao_Paulo' + 1),
           timestamp '2018-02-17 22:00 America/Sao_Paulo' + 2, extract(timezone_hour from timestamp '2018-02-17 22:00 America/Sao_Paulo' + 2),
           timestamp '2018-02-17 22:00 America/Sao_Paulo' + 3, extract(timezone_hour from timestamp '2018-02-17 22:00 America/Sao_Paulo' + 3),
           timestamp '2018-02-19 22:00 America/Sao_Paulo', extract(timezone_hour from timestamp '2018-02-19 22:00 America/Sao_Paulo'),
           timestamp '2018-02-19 22:00 America/Sao_Paulo' - 1, extract(timezone_hour from timestamp '2018-02-19 22:00 America/Sao_Paulo' - 1),
           timestamp '2018-02-19 22:00 America/Sao_Paulo' - 2, extract(timezone_hour from timestamp '2018-02-19 22:00 America/Sao_Paulo' - 2),
           timestamp '2018-02-19 22:00 America/Sao_Paulo' - 3, extract(timezone_hour from timestamp '2018-02-19 22:00 America/Sao_Paulo' - 3)
      from rdb$database;

    select 'point-11' as msg,
           dateadd(1 hour to timestamp '2018-02-17 22:00 America/Sao_Paulo'),
           dateadd(2 hour to timestamp '2018-02-17 22:00 America/Sao_Paulo'),
           dateadd(3 hour to timestamp '2018-02-17 22:00 America/Sao_Paulo'),
           dateadd(4 hour to timestamp '2018-02-17 22:00 America/Sao_Paulo')
      from rdb$database;

    select 'point-12' as msg,
           dateadd(-1 hour to timestamp '2018-02-18 01:00 America/Sao_Paulo'),
           dateadd(-2 hour to timestamp '2018-02-18 01:00 America/Sao_Paulo'),
           dateadd(-3 hour to timestamp '2018-02-18 01:00 America/Sao_Paulo'),
           dateadd(-4 hour to timestamp '2018-02-18 01:00 America/Sao_Paulo')
      from rdb$database;


    ---


    select 'point-13' as msg,
           datediff(hour from timestamp '2018-04-01 10:00:00' to timestamp '2018-04-01 10:00:00 -03'),
           datediff(hour from timestamp '2018-04-01 10:00:00 -03' to timestamp '2018-04-01 10:00:00 -03'),
           datediff(hour from timestamp '2018-04-01 10:00:00' to timestamp '2018-04-01 10:00:00 -02')
      from rdb$database;


    ---


    set time zone '-02:20';

    select 'point-14' as msg,
           cast('01:23:45' as time with time zone),
           cast('2018-01-01 01:23:45' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45' as time with time zone)),
           extract(timezone_minute from cast('01:23:45' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45' as timestamp with time zone)),
           cast(cast('01:23:45' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-15' as msg,
           cast('01:23:45 +02:00' as time with time zone),
           cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone),
           extract(timezone_hour from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_minute from cast('01:23:45 +02:00' as time with time zone)),
           extract(timezone_hour from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           extract(timezone_minute from cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone)),
           cast(cast('01:23:45 +02:00' as time with time zone) as time),
           cast(cast('2018-01-01 01:23:45 +02:00' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-16' as msg,
           extract(timezone_hour from time '03:04:05.6789 -03:00'),
           extract(timezone_minute from time '03:04:05.6789 -03:00'),
           extract(timezone_hour from timestamp '2018-01-01 03:04:05.6789 -03:00'),
           extract(timezone_minute from timestamp '2018-01-01 03:04:05.6789 -03:00')
      from rdb$database;


    ---


    select 'point-17' as msg,
           extract(timezone_hour from cast('now' as timestamp with time zone)) = -2,
           extract(timezone_minute from cast('now' as timestamp with time zone)) = -20
      from rdb$database;


    ---


    set time zone '-02:00';

    select 'point-18' as msg,
           cast('01:23:45 -01' as time),
           cast('01:23:45 +01' as time),
           cast('2018-01-01 01:23:45 -01' as timestamp),
           cast('2018-01-01 01:23:45 +01' as timestamp)
      from rdb$database;

    select 'point-19' as msg,
           cast(cast('01:23:45' as time with time zone) as timestamp with time zone) = cast(current_date || ' 01:23:45' as timestamp with time zone)
      from rdb$database;

    select 'point-20' as msg,
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as time with time zone)
      from rdb$database;

    select 'point-21' as msg,
           cast(cast('2018-01-01 01:23:45 -04' as timestamp with time zone) as time with time zone)
      from rdb$database;

    select 'point-22' as msg,
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as date)
      from rdb$database;

    select 'point-23' as msg,
           cast(cast('2018-01-01 01:23:45 -04' as timestamp with time zone) as date)
      from rdb$database;

    select 'point-24' as msg,
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as time)
      from rdb$database;

    select 'point-25' as msg,
           cast(cast('2018-01-01 01:23:45 -04' as timestamp with time zone) as time)
      from rdb$database;

    select 'point-26' as msg,
           cast(cast('2018-01-01 01:23:45' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-27' as msg,
           cast(cast('2018-01-01 01:23:45 -04' as timestamp with time zone) as timestamp)
      from rdb$database;

    select 'point-28' as msg,
           cast(timestamp '2018-01-01 01:23:45' as timestamp with time zone)
      from rdb$database;

    select 'point-29' as msg,
           cast(timestamp '2018-01-01 01:23:45' as time with time zone)
      from rdb$database;

    select 'point-30' as msg,
           cast(cast('01:23:45' as time) as timestamp with time zone) = cast(cast('01:23:45' as time with time zone) as timestamp with time zone)
      from rdb$database;

    select 'point-31' as msg,
           cast(cast('01:23:45' as time) as time with time zone) = '01:23:45 -02:00'
      from rdb$database;

    select 'point-32' as msg,
           cast(cast(cast('01:23:45 -03' as time with time zone) as timestamp) as time) = '02:23:45'
      from rdb$database;

    select 'point-33' as msg,
           cast(cast('01:23:45 -03' as time with time zone) as time) = '02:23:45'
      from rdb$database;

    -- Error
    select 'point-34' as msg,
           cast(cast('01:23:45 -03' as time with time zone) as date)
      from rdb$database;

    select 'point-35' as msg,
           cast(date '2018-01-01' as timestamp with time zone)
      from rdb$database;

    -- Error
    select 'point-36' as msg,
           cast(date '2018-01-01' as time with time zone)
      from rdb$database;


    ---


    select 'point-37' as msg,
           timestamp '2018-02-03 America/Sao_Paulo'
      from rdb$database;


    ---


    select 'point-38' as msg,
           cast('23:23:34 +05' as time with time zone) + 1,
           cast('23:23:34 +05' as time with time zone) - 1
      from rdb$database;

    select 'point-39' as msg,
           cast('2018-01-01 23:23:34 +05' as timestamp with time zone) + 1,
           cast('2018-01-01 23:23:34 +05' as timestamp with time zone) - 1
      from rdb$database;

    select 'point-40' as msg,
           date '2018-01-01' + cast('23:23:34 +05' as time with time zone),
           cast('23:23:34 +05' as time with time zone) + date '2018-01-01',
           date '2018-01-01' + cast('23:23:34 +05' as time),
           cast('23:23:34 +05' as time) + date '2018-01-01'
      from rdb$database;

    select 'point-41' as msg,
           cast('12:00:00 +01:00' as time with time zone) - cast('12:00:00 +00:00' as time with time zone),
           cast('23:00:00 -01:00' as time with time zone) - cast('23:00:00 +00:00' as time with time zone),
           time '12:00:00' - cast('12:00:00 +00:00' as time with time zone),
           cast('12:00:00 +00:00' as time with time zone) - time '12:00:00'
      from rdb$database;

    select 'point-42' as msg,
           cast('2018-01-01 12:00:00 +01:00' as timestamp with time zone) - cast('2018-01-01 12:00:00 +00:00' as timestamp with time zone),
           cast('2018-01-01 23:00:00 -01:00' as timestamp with time zone) - cast('2018-01-01 23:00:00 +00:00' as timestamp with time zone),
           timestamp '2018-01-01 12:00:00' - cast('2018-01-01 12:00:00 +00:00' as timestamp with time zone),
           cast('2018-01-01 12:00:00 +00:00' as timestamp with time zone) - timestamp '2018-01-01 12:00:00'
      from rdb$database;


    ---


    select 'point-43' as msg,
           cast('10:00:00 +05' as time with time zone) = cast('10:00:00 05' as time with time zone),
           cast('10:00:00 05' as time with time zone) = cast('11:00:00 +06' as time with time zone),
           cast('10:00:00 +12' as time with time zone) = cast('10:00:00 -12' as time with time zone),
           cast('10:00:00 -02' as time with time zone) = cast('10:00:00' as time with time zone),
           cast('10:00:00 -02' as time with time zone) = cast('10:00:00' as time),
           cast('10:00:00' as time) = cast('10:00:00 -02' as time with time zone),
           cast('10:00:00 +05' as time with time zone) = cast('10:00:00 +06' as time with time zone),
           cast('10:00:00 +05' as time with time zone) < cast('10:00:00 +06' as time with time zone),
           cast('10:00:00 +05' as time with time zone) > cast('10:00:00 +06' as time with time zone),
           localtime = current_time at time zone '-02:00'
      from rdb$database;

    select 'point-44' as msg,
           cast('2018-01-01 10:00:00 +05' as timestamp with time zone) = cast('2018-01-01 10:00:00 05' as timestamp with time zone),
           cast('2018-01-01 10:00:00 05' as timestamp with time zone) = cast('2018-01-01 11:00:00 +06' as timestamp with time zone),
           cast('2018-01-01 10:00:00 +12' as timestamp with time zone) = cast('2018-01-01 10:00:00 -12' as timestamp with time zone),
           cast('2018-01-01 10:00:00 -02' as timestamp with time zone) = cast('2018-01-01 10:00:00' as timestamp with time zone),
           cast('2018-01-01 10:00:00 -02' as timestamp with time zone) = cast('2018-01-01 10:00:00' as timestamp),
           cast('2018-01-01 10:00:00' as timestamp) = cast('2018-01-01 10:00:00 -02' as timestamp with time zone),
           cast('2018-01-01 10:00:00 +05' as timestamp with time zone) = cast('2018-01-01 10:00:00 +06' as timestamp with time zone),
           cast('2018-01-01 10:00:00 +05' as timestamp with time zone) < cast('2018-01-01 10:00:00 +06' as timestamp with time zone),
           cast('2018-01-01 10:00:00 +05' as timestamp with time zone) > cast('2018-01-01 10:00:00 +06' as timestamp with time zone),
           localtimestamp = current_timestamp at time zone '-02:00'
      from rdb$database;


    ---


    select 'point-45' as msg,
           time '20:01:02 -05:00' at time zone '-05:00',
           time '20:01:02 -05:00' at time zone '-02:00',
           time '20:01:02 -05:00' at time zone '+03:00',
           time '20:01:02' at time zone '-05:00',
           time '20:01:02' at time zone '-02:00',
           time '20:01:02' at time zone '+03:00',
           time '20:01:02 -05:00' at local,
           time '20:01:02' at local
      from rdb$database;

    select 'point-46' as msg,
           timestamp '2018-01-01 20:01:02 -05:00' at time zone '-05:00',
           timestamp '2018-01-01 20:01:02 -05:00' at time zone '-02:00',
           timestamp '2018-01-01 20:01:02 -05:00' at time zone '+03:00',
           timestamp '2018-01-01 20:01:02' at time zone '-05:00',
           timestamp '2018-01-01 20:01:02' at time zone '-02:00',
           timestamp '2018-01-01 20:01:02' at time zone '+03:00',
           timestamp '2018-01-01 20:01:02 -05:00' at local,
           timestamp '2018-01-01 20:01:02' at local
      from rdb$database;


    ---


    select 'point-47' as msg,
           timestamp '2018-05-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           timestamp '2018-04-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           timestamp '2018-03-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           timestamp '2018-02-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           timestamp '2018-01-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           timestamp '2018-01-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles' + 1,
           1 + timestamp '2018-01-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles',
           1 + timestamp '2018-01-01 20:01:02 America/Sao_Paulo' at time zone 'America/Los_Angeles' + 1
      from rdb$database;


    ---


    select 'point-48' as msg,
           first_day(of year from timestamp '2018-03-08 10:11:12 America/Sao_Paulo'),
           first_day(of month from timestamp '2018-03-08 10:11:12 America/Sao_Paulo'),
           first_day(of week from timestamp '2018-03-08 10:11:12 America/Sao_Paulo'),
           last_day(of year from timestamp '2018-03-08 10:11:12 America/Sao_Paulo'),
           last_day(of month from timestamp '2018-03-08 10:11:12 America/Sao_Paulo'),
           last_day(of week from timestamp '2018-03-08 10:11:12 America/Sao_Paulo')
      from rdb$database;


    ---


    select 'point-49' as msg,
           timestamp '2017-03-12 02:30 America/New_York' t1,
           timestamp '2017-03-12 02:30 America/New_York' at time zone '-05' t2,
           dateadd(-1 minute to timestamp '2017-03-12 02:30 America/New_York') t3,
           dateadd(1 minute to timestamp '2017-03-12 02:30 America/New_York') t4,
           dateadd(-1 hour to timestamp '2017-03-12 02:30 America/New_York') t5,
           dateadd(1 hour to timestamp '2017-03-12 02:30 America/New_York') t6
      from rdb$database;

    select 'point-50' as msg,
           timestamp '2017-11-05 01:30 America/New_York' t1,
           timestamp '2017-11-05 01:30 America/New_York' at time zone '-04' t2,
           dateadd(-1 minute to timestamp '2017-11-05 01:30 America/New_York') t3,
           dateadd(1 minute to timestamp '2017-11-05 01:30 America/New_York') t4,
           dateadd(-1 hour to timestamp '2017-11-05 01:30 America/New_York') t5,
           dateadd(1 hour to timestamp '2017-11-05 01:30 America/New_York') t6
      from rdb$database;


    ---


    set bind of timestamp with time zone to legacy;
    set bind of time with time zone to legacy;
    set sqlda_display on;

    select 'point-51' as msg,
           timestamp '2018-05-01 20:01:02 America/Sao_Paulo',
           dateadd(extract(timezone_hour from time '20:01:02 America/Sao_Paulo') + 3 hour to time '20:01:02 America/Sao_Paulo')
      from rdb$database;

    set plan;
    set planonly;
    select 'point-52' as msg,
           1
      from rdb$database
      where current_timestamp = ? and
            current_time = ?;

    set planonly;
    set plan;

    set sqlda_display off;
    set bind of timestamp with time zone to native;
    set bind of time with time zone to native;



    ---


    recreate table timetz (n integer, v time with time zone);
    create unique index timetz_uk on timetz (v);

    insert into timetz values (1, '11:33:33.456');
    insert into timetz values (2, '11:33:33.456 -1');
    insert into timetz values (3, '11:33:33.456 +1');
    insert into timetz values (4, '11:33:33');
    insert into timetz values (5, '11:33:33 -1');
    insert into timetz values (6, '11:33:33 +1');

    -- Duplicate in UTC.
    insert into timetz values (7, '12:33:33 +0');
    insert into timetz values (8, '13:33:33 +1');
    insert into timetz values (9, '14:33:33 +2');

    select 'point-53' as msg,
           n, v, cast(v as time)
    from timetz
    order by v, n;

    select 'point-54' as msg,
           n, v 
    from timetz
    order by v + 0, n;

    commit;
    drop index timetz_uk;
    create index timetz_idx on timetz (v);

    -- Duplicate in UTC.
    insert into timetz values (7, '12:33:33 +0');
    insert into timetz values (8, '13:33:33 +1');
    insert into timetz values (9, '14:33:33 +2');

    select 'point-55' as msg,
           n, v, cast(v as time)
    from timetz order by cast(v as time), n;

    select 'point-56' as msg,
           n, v, cast(v as time)
    from timetz order by v, n;

    select 'point-57' as msg,
           n, v 
    from timetz
    order by v + 0, n;

    commit;
    drop index timetz_idx;

    select 'point-58' as msg,
           n, v, cast(v as time)
    from timetz
    order by v, n;

    delete from timetz;
    insert into timetz values (1, '11:33:33.456');


    ---


    recreate table timestamptz (n integer, v timestamp with time zone);
    create unique index timestamptz_uk on timestamptz (v);

    insert into timestamptz values (1, '2018-01-01 11:33:33.456');
    insert into timestamptz values (2, '2018-01-01 11:33:33.456 -1');
    insert into timestamptz values (3, '2018-01-01 11:33:33.456 +1');
    insert into timestamptz values (4, '2018-01-01 11:33:33');
    insert into timestamptz values (5, '2018-01-01 11:33:33 -1');
    insert into timestamptz values (6, '2018-01-01 11:33:33 +1');

    -- Duplicate in UTC.
    insert into timestamptz values (7, '2018-01-01 12:33:33 +0');
    insert into timestamptz values (8, '2018-01-01 13:33:33 +1');
    insert into timestamptz values (9, '2018-01-01 14:33:33 +2');

    select 'point-59' as msg,
           n, v, cast(v as timestamp) from timestamptz order by v, n;

    select 'point-60' as msg,
           n, v from timestamptz order by v + 0, n;

    commit;
    drop index timestamptz_uk;
    create index timestamptz_idx on timestamptz (v);

    -- Duplicate in UTC.
    insert into timestamptz values (7, '2018-01-01 12:33:33 +0');
    insert into timestamptz values (8, '2018-01-01 13:33:33 +1');
    insert into timestamptz values (9, '2018-01-01 14:33:33 +2');

    select 'point-61' as msg,
           n, v, cast(v as timestamp) from timestamptz order by cast(v as timestamp), n;
    select 'point-62' as msg,
           n, v, cast(v as timestamp) from timestamptz order by v, n;

    select 'point-63' as msg,
           n, v from timestamptz order by v + 0, n;

    commit;
    drop index timestamptz_idx;

    select 'point-64' as msg,
           n, v, cast(v as timestamp) from timestamptz order by v, n;

    delete from timestamptz;
    insert into timestamptz values (1, '2018-01-01 11:33:33.456');


    ---


    select 'point-65' as msg,
           t.*,
           extract(timezone_hour from rdb$start_timestamp at time zone 'America/Los_Angeles') start_tzh,
           extract(timezone_minute from rdb$start_timestamp at time zone 'America/Los_Angeles') start_tzm,
           extract(timezone_hour from rdb$end_timestamp at time zone 'America/Los_Angeles') end_tzh,
           extract(timezone_minute from rdb$end_timestamp at time zone 'America/Los_Angeles') end_tzm
      from rdb$time_zone_util.transitions(
        'America/Los_Angeles',
        timestamp '2015-01-01 GMT',
        timestamp '2019-01-01 GMT') t;


    ---

    -- commented intentionally, PZ:
    /**********************************
    exit;
    -->> fb_sql_time_zone_b.sql
    connect "WHERE_GDB:time_zone.fdb";
    ---
    select * from timetz;
    select * from timestamptz;
    ***********************************/
    ---

    set term ^;

    set time zone 'America/Sao_Paulo'^

    select 'point-66' as msg,
           substring(current_timestamp from 26) from rdb$database^

    execute block returns (msg varchar(30), t1 varchar(30), t2 varchar(30))
    as
        declare procedure p0 returns (t1 varchar(30), t2 varchar(30))
        as
        begin
            set time zone 'America/New_York';
            t1 = substring(current_timestamp from 26);
            set time zone local;
            t2 = substring(current_timestamp from 26);
        end

        declare procedure p1 returns (t1 varchar(30), t2 varchar(30))
        as
        begin
            set time zone 'America/Los_Angeles';

            execute procedure p0 returning_values t1, t2;
        end
    begin
        execute procedure p1 returning_values t1, t2;
        msg = 'point-67';
        suspend;
    end^

    select 'point-68' as msg,
           substring(current_timestamp from 26) from rdb$database^


    set time zone 'America/Sao_Paulo'^

    execute block returns (msg varchar(30), n integer, t1 varchar(30), t2 varchar(30), t3 varchar(30))
    as
        declare procedure p1 returns (n integer, t1 varchar(30), t2 varchar(30), t3 varchar(30))
        as
        begin
            n = 0;

            while (n <= 4)
            do
            begin
                t1 = substring(current_timestamp from 26);
                set time zone 'America/Los_Angeles';
                t2 = substring(current_timestamp from 26);
                if (n <= 2) then
                    set time zone local;
                t3 = substring(current_timestamp from 26);
                suspend;

                n = n + 1;
            end
        end
    begin
        msg = 'point-68';
        for select n, t1, t2, t3 from p1 into n, t1, t2, t3
        do
        begin
            suspend;
        end
    end^


    set time zone 'America/Sao_Paulo'^

    recreate table t1 (n integer, tz1 varchar(30), tz2 varchar(30), tz3 varchar(30))^

    create trigger t1_bi before insert on t1
    as
    begin
        new.tz1 = substring(current_timestamp from 26);
        set time zone 'America/New_York';
        new.tz2 = substring(current_timestamp from 26);
        set time zone local;
        new.tz3 = substring(current_timestamp from 26);
    end^

    insert into t1 (n) values (1)^
    select 'point-69' as msg, t.* from t1 t
    ^
    set term ;^
  """,
 'expected_stdout':
  """
    MSG                             point-01
    CAST                            01:23:45.0000 +00:00
    CAST                            2018-01-01 01:23:45.0000 +00:00
    EXTRACT                         0
    EXTRACT                         0
    EXTRACT                         0
    EXTRACT                         0
    CAST                            01:23:45.0000
    CAST                            2018-01-01 01:23:45.0000



    MSG                             point-02
    CAST                            01:23:45.0000 +02:00
    CAST                            2018-01-01 01:23:45.0000 +02:00
    EXTRACT                         2
    EXTRACT                         0
    EXTRACT                         2
    EXTRACT                         0
    CAST                            23:23:45.0000
    CAST                            2017-12-31 23:23:45.0000



    MSG                             point-03
    CONSTANT                        01:23:45.0000 +02:00
    CONSTANT                        2018-01-01 01:23:45.0000 +02:00
    EXTRACT                         2
    EXTRACT                         0
    EXTRACT                         2
    EXTRACT                         0
    CAST                            23:23:45.0000
    CAST                            2017-12-31 23:23:45.0000



    MSG                             point-04
    CAST                            01:23:45.0000 -02:00
    CAST                            2018-01-01 01:23:45.0000 -02:00
    EXTRACT                         -2
    EXTRACT                         0
    EXTRACT                         -2
    EXTRACT                         0
    CAST                            01:23:45.0000
    CAST                            2018-01-01 01:23:45.0000



    MSG                             point-05
    CAST                            01:23:45.0000 +02:00
    CAST                            2018-01-01 01:23:45.0000 +02:00
    EXTRACT                         2
    EXTRACT                         0
    EXTRACT                         2
    EXTRACT                         0
    CAST                            21:23:45.0000
    CAST                            2017-12-31 21:23:45.0000



    MSG                             point-06
    EXTRACT                         3
    EXTRACT                         4
    EXTRACT                         5.6789
    EXTRACT                         678.9
    EXTRACT                         2018
    EXTRACT                         1
    EXTRACT                         2



    MSG                             point-07
    EXTRACT                         3
    EXTRACT                         4
    EXTRACT                         5.6789
    EXTRACT                         678.9



    MSG                             point-08
    CONSTANT                        2017-10-14 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    ADD                             2017-10-15 23:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    ADD                             2017-10-16 23:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    ADD                             2017-10-17 23:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    CONSTANT                        2017-10-16 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    SUBTRACT                        2017-10-15 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    SUBTRACT                        2017-10-14 21:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    SUBTRACT                        2017-10-13 21:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3



    MSG                             point-09
    DATEADD                         2017-10-14 21:00:00.0000 America/Sao_Paulo
    DATEADD                         2017-10-14 22:00:00.0000 America/Sao_Paulo
    DATEADD                         2017-10-14 23:00:00.0000 America/Sao_Paulo
    DATEADD                         2017-10-15 01:00:00.0000 America/Sao_Paulo
    DATEADD                         2017-10-15 02:00:00.0000 America/Sao_Paulo



    MSG                             point-10
    CONSTANT                        2018-02-17 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    ADD                             2018-02-18 21:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    ADD                             2018-02-19 21:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    ADD                             2018-02-20 21:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    CONSTANT                        2018-02-19 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    SUBTRACT                        2018-02-18 22:00:00.0000 America/Sao_Paulo
    EXTRACT                         -3
    SUBTRACT                        2018-02-17 23:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2
    SUBTRACT                        2018-02-16 23:00:00.0000 America/Sao_Paulo
    EXTRACT                         -2



    MSG                             point-11
    DATEADD                         2018-02-17 23:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-17 23:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-18 00:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-18 01:00:00.0000 America/Sao_Paulo



    MSG                             point-12
    DATEADD                         2018-02-18 00:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-17 23:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-17 23:00:00.0000 America/Sao_Paulo
    DATEADD                         2018-02-17 22:00:00.0000 America/Sao_Paulo



    MSG                             point-13
    DATEDIFF                        1
    DATEDIFF                        0
    DATEDIFF                        0



    MSG                             point-14
    CAST                            01:23:45.0000 -02:20
    CAST                            2018-01-01 01:23:45.0000 -02:20
    EXTRACT                         -2
    EXTRACT                         -20
    EXTRACT                         -2
    EXTRACT                         -20
    CAST                            01:23:45.0000
    CAST                            2018-01-01 01:23:45.0000



    MSG                             point-15
    CAST                            01:23:45.0000 +02:00
    CAST                            2018-01-01 01:23:45.0000 +02:00
    EXTRACT                         2
    EXTRACT                         0
    EXTRACT                         2
    EXTRACT                         0
    CAST                            21:03:45.0000
    CAST                            2017-12-31 21:03:45.0000



    MSG                             point-16
    EXTRACT                         -3
    EXTRACT                         0
    EXTRACT                         -3
    EXTRACT                         0



    MSG                             point-17
                                    <true>
                                    <true>



    MSG                             point-18
    CAST                            00:23:45.0000
    CAST                            22:23:45.0000
    CAST                            2018-01-01 00:23:45.0000
    CAST                            2017-12-31 22:23:45.0000



    MSG                             point-19
                                    <true>



    MSG                             point-20
    CAST                            01:23:45.0000 -02:00



    MSG                             point-21
    CAST                            01:23:45.0000 -04:00



    MSG                             point-22
    CAST                            2018-01-01



    MSG                             point-23
    CAST                            2018-01-01



    MSG                             point-24
    CAST                            01:23:45.0000



    MSG                             point-25
    CAST                            03:23:45.0000



    MSG                             point-26
    CAST                            2018-01-01 01:23:45.0000



    MSG                             point-27
    CAST                            2018-01-01 03:23:45.0000



    MSG                             point-28
    CAST                            2018-01-01 01:23:45.0000 -02:00



    MSG                             point-29
    CAST                            01:23:45.0000 -02:00



    MSG                             point-30
                                    <true>



    MSG                             point-31
                                    <true>



    MSG                             point-32
                                    <true>



    MSG                             point-33
                                    <true>




    MSG                             point-35
    CAST                            2018-01-01 00:00:00.0000 -02:00




    MSG                             point-37
    CONSTANT                        2018-02-03 00:00:00.0000 America/Sao_Paulo



    MSG                             point-38
    ADD                             23:23:35.0000 +05:00
    SUBTRACT                        23:23:33.0000 +05:00



    MSG                             point-39
    ADD                             2018-01-02 23:23:34.0000 +05:00
    SUBTRACT                        2017-12-31 23:23:34.0000 +05:00



    MSG                             point-40
    ADD                             2018-01-01 23:23:34.0000 +05:00
    ADD                             2018-01-01 23:23:34.0000 +05:00
    ADD                             2018-01-01 16:23:34.0000
    ADD                             2018-01-01 16:23:34.0000



    MSG                             point-41
    SUBTRACT                        -3600.0000
    SUBTRACT                        -82800.0000
    SUBTRACT                        7200.0000
    SUBTRACT                        -7200.0000



    MSG                             point-42
    SUBTRACT                        -0.041666667
    SUBTRACT                        0.041666667
    SUBTRACT                        0.083333333
    SUBTRACT                        -0.083333333



    MSG                             point-43
                                    <true>
                                    <true>
                                    <true>
                                    <true>
                                    <true>
                                    <true>
                                    <false>
                                    <false>
                                    <true>
                                    <true>



    MSG                             point-44
                                    <true>
                                    <true>
                                    <false>
                                    <true>
                                    <true>
                                    <true>
                                    <false>
                                    <false>
                                    <true>
                                    <true>



    MSG                             point-45
    AT                              20:01:02.0000 -05:00
    AT                              23:01:02.0000 -02:00
    AT                              04:01:02.0000 +03:00
    AT                              17:01:02.0000 -05:00
    AT                              20:01:02.0000 -02:00
    AT                              01:01:02.0000 +03:00
    AT                              23:01:02.0000 -02:00
    AT                              20:01:02.0000 -02:00



    MSG                             point-46
    AT                              2018-01-01 20:01:02.0000 -05:00
    AT                              2018-01-01 23:01:02.0000 -02:00
    AT                              2018-01-02 04:01:02.0000 +03:00
    AT                              2018-01-01 17:01:02.0000 -05:00
    AT                              2018-01-01 20:01:02.0000 -02:00
    AT                              2018-01-02 01:01:02.0000 +03:00
    AT                              2018-01-01 23:01:02.0000 -02:00
    AT                              2018-01-01 20:01:02.0000 -02:00



    MSG                             point-47
    AT                              2018-05-01 16:01:02.0000 America/Los_Angeles
    AT                              2018-04-01 16:01:02.0000 America/Los_Angeles
    AT                              2018-03-01 15:01:02.0000 America/Los_Angeles
    AT                              2018-02-01 14:01:02.0000 America/Los_Angeles
    AT                              2018-01-01 14:01:02.0000 America/Los_Angeles
    ADD                             2018-01-02 14:01:02.0000 America/Los_Angeles
    ADD                             2018-01-02 14:01:02.0000 America/Los_Angeles
    ADD                             2018-01-03 14:01:02.0000 America/Los_Angeles



    MSG                             point-48
    FIRST_DAY                       2018-01-01 10:11:12.0000 America/Sao_Paulo
    FIRST_DAY                       2018-03-01 10:11:12.0000 America/Sao_Paulo
    FIRST_DAY                       2018-03-04 10:11:12.0000 America/Sao_Paulo
    LAST_DAY                        2018-12-31 10:11:12.0000 America/Sao_Paulo
    LAST_DAY                        2018-03-31 10:11:12.0000 America/Sao_Paulo
    LAST_DAY                        2018-03-10 10:11:12.0000 America/Sao_Paulo



    MSG                             point-49
    T1                              2017-03-12 03:30:00.0000 America/New_York
    T2                              2017-03-12 02:30:00.0000 -05:00
    T3                              2017-03-12 03:29:00.0000 America/New_York
    T4                              2017-03-12 03:31:00.0000 America/New_York
    T5                              2017-03-12 01:30:00.0000 America/New_York
    T6                              2017-03-12 04:30:00.0000 America/New_York



    MSG                             point-50
    T1                              2017-11-05 01:30:00.0000 America/New_York
    T2                              2017-11-05 01:30:00.0000 -04:00
    T3                              2017-11-05 01:29:00.0000 America/New_York
    T4                              2017-11-05 01:31:00.0000 America/New_York
    T5                              2017-11-05 00:30:00.0000 America/New_York
    T6                              2017-11-05 01:30:00.0000 America/New_York



    INPUT message field count: 0

    OUTPUT message field count: 3
    01: sqltype: 452 TEXT scale: 0 subtype: 0 len: 8 charset: 0 NONE
      :  name: CONSTANT  alias: MSG
      : table:   owner: 
    02: sqltype: 510 TIMESTAMP scale: 0 subtype: 0 len: 8
      :  name: CONSTANT  alias: CONSTANT
      : table:   owner: 
    03: sqltype: 560 TIME scale: 0 subtype: 0 len: 4
      :  name: DATEADD  alias: DATEADD
      : table:   owner: 

    MSG                             point-51
    CONSTANT                        2018-05-01 21:01:02.0000
    DATEADD                         21:01:02.0000



    INPUT message field count: 2
    01: sqltype: 510 TIMESTAMP scale: 0 subtype: 0 len: 8
      :  name:   alias: 
      : table:   owner: 
    02: sqltype: 560 TIME scale: 0 subtype: 0 len: 4
      :  name:   alias: 
      : table:   owner: 

    PLAN (RDB$DATABASE NATURAL)

    OUTPUT message field count: 2
    01: sqltype: 452 TEXT scale: 0 subtype: 0 len: 8 charset: 0 NONE
      :  name: CONSTANT  alias: MSG
      : table:   owner: 
    02: sqltype: 496 LONG scale: 0 subtype: 0 len: 4
      :  name: CONSTANT  alias: CONSTANT
      : table:   owner: 

    MSG                             point-53
    N                               6
    V                               11:33:33.0000 +01:00
    CAST                            08:33:33.0000

    MSG                             point-53
    N                               3
    V                               11:33:33.4560 +01:00
    CAST                            08:33:33.4560

    MSG                             point-53
    N                               5
    V                               11:33:33.0000 -01:00
    CAST                            10:33:33.0000

    MSG                             point-53
    N                               2
    V                               11:33:33.4560 -01:00
    CAST                            10:33:33.4560

    MSG                             point-53
    N                               4
    V                               11:33:33.0000 -02:00
    CAST                            11:33:33.0000

    MSG                             point-53
    N                               1
    V                               11:33:33.4560 -02:00
    CAST                            11:33:33.4560



    MSG                             point-54
    N                               6
    V                               11:33:33.0000 +01:00

    MSG                             point-54
    N                               3
    V                               11:33:33.4560 +01:00

    MSG                             point-54
    N                               5
    V                               11:33:33.0000 -01:00

    MSG                             point-54
    N                               2
    V                               11:33:33.4560 -01:00

    MSG                             point-54
    N                               4
    V                               11:33:33.0000 -02:00

    MSG                             point-54
    N                               1
    V                               11:33:33.4560 -02:00



    MSG                             point-55
    N                               6
    V                               11:33:33.0000 +01:00
    CAST                            08:33:33.0000

    MSG                             point-55
    N                               3
    V                               11:33:33.4560 +01:00
    CAST                            08:33:33.4560

    MSG                             point-55
    N                               5
    V                               11:33:33.0000 -01:00
    CAST                            10:33:33.0000

    MSG                             point-55
    N                               7
    V                               12:33:33.0000 +00:00
    CAST                            10:33:33.0000

    MSG                             point-55
    N                               8
    V                               13:33:33.0000 +01:00
    CAST                            10:33:33.0000

    MSG                             point-55
    N                               9
    V                               14:33:33.0000 +02:00
    CAST                            10:33:33.0000

    MSG                             point-55
    N                               2
    V                               11:33:33.4560 -01:00
    CAST                            10:33:33.4560

    MSG                             point-55
    N                               4
    V                               11:33:33.0000 -02:00
    CAST                            11:33:33.0000

    MSG                             point-55
    N                               1
    V                               11:33:33.4560 -02:00
    CAST                            11:33:33.4560



    MSG                             point-56
    N                               6
    V                               11:33:33.0000 +01:00
    CAST                            08:33:33.0000

    MSG                             point-56
    N                               3
    V                               11:33:33.4560 +01:00
    CAST                            08:33:33.4560

    MSG                             point-56
    N                               5
    V                               11:33:33.0000 -01:00
    CAST                            10:33:33.0000

    MSG                             point-56
    N                               7
    V                               12:33:33.0000 +00:00
    CAST                            10:33:33.0000

    MSG                             point-56
    N                               8
    V                               13:33:33.0000 +01:00
    CAST                            10:33:33.0000

    MSG                             point-56
    N                               9
    V                               14:33:33.0000 +02:00
    CAST                            10:33:33.0000

    MSG                             point-56
    N                               2
    V                               11:33:33.4560 -01:00
    CAST                            10:33:33.4560

    MSG                             point-56
    N                               4
    V                               11:33:33.0000 -02:00
    CAST                            11:33:33.0000

    MSG                             point-56
    N                               1
    V                               11:33:33.4560 -02:00
    CAST                            11:33:33.4560



    MSG                             point-57
    N                               6
    V                               11:33:33.0000 +01:00

    MSG                             point-57
    N                               3
    V                               11:33:33.4560 +01:00

    MSG                             point-57
    N                               5
    V                               11:33:33.0000 -01:00

    MSG                             point-57
    N                               7
    V                               12:33:33.0000 +00:00

    MSG                             point-57
    N                               8
    V                               13:33:33.0000 +01:00

    MSG                             point-57
    N                               9
    V                               14:33:33.0000 +02:00

    MSG                             point-57
    N                               2
    V                               11:33:33.4560 -01:00

    MSG                             point-57
    N                               4
    V                               11:33:33.0000 -02:00

    MSG                             point-57
    N                               1
    V                               11:33:33.4560 -02:00



    MSG                             point-58
    N                               6
    V                               11:33:33.0000 +01:00
    CAST                            08:33:33.0000

    MSG                             point-58
    N                               3
    V                               11:33:33.4560 +01:00
    CAST                            08:33:33.4560

    MSG                             point-58
    N                               5
    V                               11:33:33.0000 -01:00
    CAST                            10:33:33.0000

    MSG                             point-58
    N                               7
    V                               12:33:33.0000 +00:00
    CAST                            10:33:33.0000

    MSG                             point-58
    N                               8
    V                               13:33:33.0000 +01:00
    CAST                            10:33:33.0000

    MSG                             point-58
    N                               9
    V                               14:33:33.0000 +02:00
    CAST                            10:33:33.0000

    MSG                             point-58
    N                               2
    V                               11:33:33.4560 -01:00
    CAST                            10:33:33.4560

    MSG                             point-58
    N                               4
    V                               11:33:33.0000 -02:00
    CAST                            11:33:33.0000

    MSG                             point-58
    N                               1
    V                               11:33:33.4560 -02:00
    CAST                            11:33:33.4560



    MSG                             point-59
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00
    CAST                            2018-01-01 08:33:33.0000

    MSG                             point-59
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00
    CAST                            2018-01-01 08:33:33.4560

    MSG                             point-59
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-59
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00
    CAST                            2018-01-01 10:33:33.4560

    MSG                             point-59
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00
    CAST                            2018-01-01 11:33:33.0000

    MSG                             point-59
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00
    CAST                            2018-01-01 11:33:33.4560



    MSG                             point-60
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00

    MSG                             point-60
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00

    MSG                             point-60
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00

    MSG                             point-60
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00

    MSG                             point-60
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00

    MSG                             point-60
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00



    MSG                             point-61
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00
    CAST                            2018-01-01 08:33:33.0000

    MSG                             point-61
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00
    CAST                            2018-01-01 08:33:33.4560

    MSG                             point-61
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-61
    N                               7
    V                               2018-01-01 12:33:33.0000 +00:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-61
    N                               8
    V                               2018-01-01 13:33:33.0000 +01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-61
    N                               9
    V                               2018-01-01 14:33:33.0000 +02:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-61
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00
    CAST                            2018-01-01 10:33:33.4560

    MSG                             point-61
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00
    CAST                            2018-01-01 11:33:33.0000

    MSG                             point-61
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00
    CAST                            2018-01-01 11:33:33.4560



    MSG                             point-62
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00
    CAST                            2018-01-01 08:33:33.0000

    MSG                             point-62
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00
    CAST                            2018-01-01 08:33:33.4560

    MSG                             point-62
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-62
    N                               7
    V                               2018-01-01 12:33:33.0000 +00:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-62
    N                               8
    V                               2018-01-01 13:33:33.0000 +01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-62
    N                               9
    V                               2018-01-01 14:33:33.0000 +02:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-62
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00
    CAST                            2018-01-01 10:33:33.4560

    MSG                             point-62
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00
    CAST                            2018-01-01 11:33:33.0000

    MSG                             point-62
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00
    CAST                            2018-01-01 11:33:33.4560



    MSG                             point-63
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00

    MSG                             point-63
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00

    MSG                             point-63
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00

    MSG                             point-63
    N                               7
    V                               2018-01-01 12:33:33.0000 +00:00

    MSG                             point-63
    N                               8
    V                               2018-01-01 13:33:33.0000 +01:00

    MSG                             point-63
    N                               9
    V                               2018-01-01 14:33:33.0000 +02:00

    MSG                             point-63
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00

    MSG                             point-63
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00

    MSG                             point-63
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00



    MSG                             point-64
    N                               6
    V                               2018-01-01 11:33:33.0000 +01:00
    CAST                            2018-01-01 08:33:33.0000

    MSG                             point-64
    N                               3
    V                               2018-01-01 11:33:33.4560 +01:00
    CAST                            2018-01-01 08:33:33.4560

    MSG                             point-64
    N                               5
    V                               2018-01-01 11:33:33.0000 -01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-64
    N                               7
    V                               2018-01-01 12:33:33.0000 +00:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-64
    N                               8
    V                               2018-01-01 13:33:33.0000 +01:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-64
    N                               9
    V                               2018-01-01 14:33:33.0000 +02:00
    CAST                            2018-01-01 10:33:33.0000

    MSG                             point-64
    N                               2
    V                               2018-01-01 11:33:33.4560 -01:00
    CAST                            2018-01-01 10:33:33.4560

    MSG                             point-64
    N                               4
    V                               2018-01-01 11:33:33.0000 -02:00
    CAST                            2018-01-01 11:33:33.0000

    MSG                             point-64
    N                               1
    V                               2018-01-01 11:33:33.4560 -02:00
    CAST                            2018-01-01 11:33:33.4560



    MSG                             point-65
    RDB$START_TIMESTAMP             2014-11-02 09:00:00.0000 GMT
    RDB$END_TIMESTAMP               2015-03-08 09:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  0
    RDB$EFFECTIVE_OFFSET            -480
    START_TZH                       -8
    START_TZM                       0
    END_TZH                         -8
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2015-03-08 10:00:00.0000 GMT
    RDB$END_TIMESTAMP               2015-11-01 08:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  60
    RDB$EFFECTIVE_OFFSET            -420
    START_TZH                       -7
    START_TZM                       0
    END_TZH                         -7
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2015-11-01 09:00:00.0000 GMT
    RDB$END_TIMESTAMP               2016-03-13 09:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  0
    RDB$EFFECTIVE_OFFSET            -480
    START_TZH                       -8
    START_TZM                       0
    END_TZH                         -8
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2016-03-13 10:00:00.0000 GMT
    RDB$END_TIMESTAMP               2016-11-06 08:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  60
    RDB$EFFECTIVE_OFFSET            -420
    START_TZH                       -7
    START_TZM                       0
    END_TZH                         -7
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2016-11-06 09:00:00.0000 GMT
    RDB$END_TIMESTAMP               2017-03-12 09:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  0
    RDB$EFFECTIVE_OFFSET            -480
    START_TZH                       -8
    START_TZM                       0
    END_TZH                         -8
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2017-03-12 10:00:00.0000 GMT
    RDB$END_TIMESTAMP               2017-11-05 08:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  60
    RDB$EFFECTIVE_OFFSET            -420
    START_TZH                       -7
    START_TZM                       0
    END_TZH                         -7
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2017-11-05 09:00:00.0000 GMT
    RDB$END_TIMESTAMP               2018-03-11 09:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  0
    RDB$EFFECTIVE_OFFSET            -480
    START_TZH                       -8
    START_TZM                       0
    END_TZH                         -8
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2018-03-11 10:00:00.0000 GMT
    RDB$END_TIMESTAMP               2018-11-04 08:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  60
    RDB$EFFECTIVE_OFFSET            -420
    START_TZH                       -7
    START_TZM                       0
    END_TZH                         -7
    END_TZM                         0

    MSG                             point-65
    RDB$START_TIMESTAMP             2018-11-04 09:00:00.0000 GMT
    RDB$END_TIMESTAMP               2019-03-10 09:59:59.9999 GMT
    RDB$ZONE_OFFSET                 -480
    RDB$DST_OFFSET                  0
    RDB$EFFECTIVE_OFFSET            -480
    START_TZH                       -8
    START_TZM                       0
    END_TZH                         -8
    END_TZM                         0



    MSG                             point-66
    SUBSTRING                       America/Sao_Paulo



    MSG                             point-67
    T1                              America/New_York
    T2                              America/Los_Angeles



    MSG                             point-68
    SUBSTRING                       America/Los_Angeles



    MSG                             point-68
    N                               0
    T1                              America/Sao_Paulo
    T2                              America/Los_Angeles
    T3                              America/Sao_Paulo

    MSG                             point-68
    N                               1
    T1                              America/Sao_Paulo
    T2                              America/Los_Angeles
    T3                              America/Sao_Paulo

    MSG                             point-68
    N                               2
    T1                              America/Sao_Paulo
    T2                              America/Los_Angeles
    T3                              America/Sao_Paulo

    MSG                             point-68
    N                               3
    T1                              America/Sao_Paulo
    T2                              America/Los_Angeles
    T3                              America/Los_Angeles

    MSG                             point-68
    N                               4
    T1                              America/Los_Angeles
    T2                              America/Los_Angeles
    T3                              America/Los_Angeles



    MSG                             point-69
    N                               1
    TZ1                             America/Sao_Paulo
    TZ2                             America/New_York
    TZ3                             America/Sao_Paulo
  """,
 'expected_stderr':
  """
    Statement failed, SQLSTATE = 22018
    conversion error from string "01:23:45.0000 -03:00"

    Statement failed, SQLSTATE = 22018
    conversion error from string "2018-01-01"

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMETZ_UK"
    -Problematic key value is ("V" = '12:33:33.0000 +00:00')

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMETZ_UK"
    -Problematic key value is ("V" = '13:33:33.0000 +01:00')

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMETZ_UK"
    -Problematic key value is ("V" = '14:33:33.0000 +02:00')

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMESTAMPTZ_UK"
    -Problematic key value is ("V" = '2018-01-01 12:33:33.0000 +00:00')

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMESTAMPTZ_UK"
    -Problematic key value is ("V" = '2018-01-01 13:33:33.0000 +01:00')

    Statement failed, SQLSTATE = 23000
    attempt to store duplicate value (visible to active transactions) in unique index "TIMESTAMPTZ_UK"
    -Problematic key value is ("V" = '2018-01-01 14:33:33.0000 +02:00')
  """,
  'substitutions':[('[ \t]+', ' ')]
}
]
}
